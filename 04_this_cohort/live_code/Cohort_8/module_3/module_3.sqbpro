<?xml version="1.0" encoding="UTF-8"?><sqlb_project><db path="C:/Users/armit/dsi5/sql/05_src/sql/farmersmarket.db" readonly="0" foreign_keys="1" case_sensitive_like="0" temp_store="0" wal_autocheckpoint="1000" synchronous="2"/><attached/><window><main_tabs open="structure browser pragmas query" current="3"/></window><tab_structure><column_width id="0" width="300"/><column_width id="1" width="0"/><column_width id="2" width="100"/><column_width id="3" width="8651"/><column_width id="4" width="0"/><expanded_item id="0" parent="1"/><expanded_item id="1" parent="1"/><expanded_item id="2" parent="1"/><expanded_item id="3" parent="1"/></tab_structure><tab_browse><table title="customer_purchases" custom_title="0" dock_id="4" table="4,18:maincustomer_purchases"/><dock_state state="000000ff00000000fd0000000100000002000002d700000355fc0100000003fb000000160064006f0063006b00420072006f00770073006500310100000000ffffffff0000000000000000fb000000160064006f0063006b00420072006f00770073006500320100000000000005360000000000000000fb000000160064006f0063006b00420072006f00770073006500340100000000000002d70000011700ffffff000002d70000000000000004000000040000000800000008fc00000000"/><default_encoding codec=""/><browse_table_settings><table schema="main" name="booth" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_" freeze_columns="0"><sort/><column_widths><column index="1" value="90"/><column index="2" value="108"/><column index="3" value="300"/><column index="4" value="72"/></column_widths><filter_values/><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table><table schema="main" name="customer_purchases" show_row_id="0" encoding="" plot_x_axis="" unlock_view_pk="_rowid_" freeze_columns="0"><sort><column index="3" mode="1"/></sort><column_widths><column index="1" value="69"/><column index="2" value="64"/><column index="3" value="85"/><column index="4" value="79"/><column index="5" value="55"/><column index="6" value="158"/><column index="7" value="103"/></column_widths><filter_values><column index="3" value="10"/><column index="2" value="2022-04-05"/></filter_values><conditional_formats/><row_id_formats/><display_formats/><hidden_columns/><plot_y_axes/><global_filter/></table></browse_table_settings></tab_browse><tab_sql><sql name="COUNT">/* MODULE 3 */
/* COUNT */


/* 1. Count the number of products */
 
SELECT COUNT (product_id) as num_of_prods
FROM product;
 
/* 2. How many products per product_qty_type */
SELECT product_qty_type
,COUNT (product_id) as num_of_prods
FROM product
GROUP BY product_qty_type;


/* 3. How many products per product_qty_type and per their product_size */

SELECT product_size
, product_qty_type
, COUNT (product_id) as num_of_prods

FROM product
GROUP BY product_size, product_qty_type;

/* COUNT DISTINCT 
    4. How many unique products were bought */

SELECT COUNT(DISTINCT product_id) as bought_prod
FROM customer_purchases;
</sql><sql name="SUM_AVG">/* MODULE 3 */
/* SUM &amp; AVG */


/* 1. How much did customers spend each day */
SELECT
market_date
,customer_id
,SUM(quantity*cost_to_customer_per_qty)as total_coat

FROM customer_purchases
GROUP BY market_date,customer_id;
 

/* 2. How much does each customer spend on average */

SELECT
customer_first_name
,customer_last_name
,ROUND(AVG(quantity*cost_to_customer_per_qty),2) as total_cost

FROM customer_purchases as cp
INNER JOIN customer as c
	on c.customer_id=cp.customer_id
GROUP BY c.customer_id;</sql><sql name="MIN_MAX*">/* MODULE 3 */
/* MIN &amp; MAX */


/* 1. What is the most expensive product 
...pay attention to how it doesn't handle ties very well
*/
SELECT 
 product_name
 ,MAX(original_price) as most_expensive
 
 FROM product p
 INNER JOIN vendor_inventoryvi
	ON p.product=vi.product_id;

/* 2. Prove that max is working */



/* 3. Find the minimum price per each product_qty_type */

SELECT
product_name
,product_qty_type
,min(original_price) as least_exp
FROM product as p
INNER JOIN vendor_inventory as vi

/* 4. Prove that min is working */



/* 5. Min/max on a string 
... not particularly useful? */


</sql><sql name="arithmitic*">/* MODULE 3 */
/* Arithmitic */


/* 1. power, pi(), ceiling, division, integer division, etc */
SELECT 
power(2,2)
,pi() as [pi]
,10.0/3.0 as division
,cast(10.0 as int)/cast(3.0 as int) as integer_division
,ceiling(4.5) as [ceiling];

/* 2. Every even vendor_id with modulo */
SELECT *

FROM vendor
WHERE vendor_id %2 = 0;

/* 3. What about every third?  */

SELECT *

FROM vendor
WHERE vendor_id %3 = 1;</sql><sql name="HAVING*">/* MODULE 3 */
/* HAVING */


/* 1. How much did a customer spend on each day?
Filter to customer_id between 1 and 5 and total_cost &gt; 50 
... What order of execution occurs?*/
 
SELECT --fifth
market_date
,customer_id
,SUM(quantity*cost_to_customer_per_qty) as total_spend

FROM customer_purchases  --first
WHERE customer_id BETWEEN 1 AND 5 --Second

GROUP BY market_date,customer_id --third
HAVING total_spend &gt;50; --fourth

/* 2. How many products were bought?
Filter to number of purchases between 300 and 500  */

SELECT 

count(product_id) as num_of_prod
,product_id

FROM customer_purchases
GROUP BY product_id 
HAVING count (product_id) BETWEEN 300 AND 500 AND product_id = 8</sql><sql name="subquery_joins*">/* MODULE 3 */
/* Subquery FROM */


/*1. Simple subquery in a FROM statement, e.g. for inflation
...we could imagine joining this to a more complex query perhaps */

SELECT 

FROM (
select PRO


)




/* 2. What is the single item that has been bought in the greatest quantity?*/


</sql><sql name="subquery_where">/* MODULE 3 */
/* Subquery WHERE */


/* 1. How much did each customer spend at each vendor for each day at the market WHEN IT RAINS */




/* 2. What is the name of the vendor who sells pie */

</sql><sql name="temp_table">/* MODULE 3 */
/* Temp Tables */


/* 1. Put our inflation query into a temp table, e.g. as temp.new_vendor_inventory*/

/* some structural code */
/* ...heads up, sometimes this query can be finnicky -- it's good to try highlighting different sections to help it succeed...*/

-- if a table named new_vendor_inventory exists, delete it, other do NOTHING
DROP TABLE IF EXISTS temp.new_vendor_inventory;

--make the table
CREATE TABLE temp.new_vendor_inventory AS

-- definition of the table





/* 2. put the previous table into another temp table, e.g. as temp.new_new_vendor_inventory  */


</sql><sql name="CTE">/* MODULE 3 */
/* Common Table Expression (CTE) */


/* 1. Calculate sales per vendor per day */
SELECT 





/* ... re-aggregate the daily sales for each WEEK instead now  */

</sql><sql name="dates">/* MODULE 3 */
/* Date functions */


/* 1. now */
SELECT 


/* 2. strftime */



/* 3. adding dates, e.g. last date of the month */



/* 4. difference between dates, 
 a. number of days between now and each market_date
 b. number of YEARS between now and market_date
 c. number of HOURS bewtween now and market_date
 */
</sql><current_tab id="8"/></tab_sql></sqlb_project>
